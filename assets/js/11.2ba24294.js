(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{256:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"控制器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#控制器","aria-hidden":"true"}},[t._v("#")]),t._v(" 控制器")]),t._v(" "),a("p",[t._v("虽然闭包可能足以处理小型应用程序的路由逻辑，但当应用程序开始增长时，在其他地方组织应用程序逻辑会很有用。")]),t._v(" "),a("p",[t._v("这是控制器发挥作用的地方。")]),t._v(" "),a("p",[t._v("控制器连接到一个或多个路由，将相关的请求处理逻辑分组到单个文件中，控制器是模型、视图和你可能需要的任何其他服务之间的共同交互点。")]),t._v(" "),a("blockquote",[a("p",[t._v("控制器唯一的工作是响应HTTP请求。不要在不同的文件中引入它们。")])]),t._v(" "),a("h2",{attrs:{id:"创建控制器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建控制器","aria-hidden":"true"}},[t._v("#")]),t._v(" 创建控制器")]),t._v(" "),a("p",[t._v("要创建新控制器，请使用以下 "),a("strong",[t._v("make:controller")]),t._v(" 命令：")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# HTTP Controller")]),t._v("\n adonis make:controller User --type http\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# WS Controller")]),t._v("\n adonis make:controller User --type ws\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Will use an Admin subfolder")]),t._v("\n adonis make:controller Admin/User\n")])])]),a("p",[t._v("此命令在 App/Controllers/{TYPE} 文件夹中创建样板文件：")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'use strict'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserController")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" UserController\n")])])]),a("blockquote",[a("p",[t._v("使用该 --resource 标签创建一个资源控制器。")])]),t._v(" "),a("h2",{attrs:{id:"使用控制器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用控制器","aria-hidden":"true"}},[t._v("#")]),t._v(" 使用控制器")]),t._v(" "),a("p",[t._v("只能从路由访问控制器。")]),t._v(" "),a("p",[t._v("这是通过将控制器作为路由定义中的字符串引用来完成的：")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("Route"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'UserController.index'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("点之前的部分是对控制器文件的引用(例如 UserController )，默认情况下命名为 "),a("strong",[t._v("App/Controllers/Http")]),t._v(" 。")]),t._v(" "),a("p",[t._v("点后面的部分是你要在此控制器内调用的方法的名称(例如 index )。")]),t._v(" "),a("p",[t._v("例如：")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// app/Controllers/Http/UserController -> index()")]),t._v("\nRoute"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'UserController.index'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// app/Controllers/Http/Admin/UserController -> store()")]),t._v("\nRoute"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Admin/UserController.store'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// app/MyOwnControllers/UserController -> index()")]),t._v("\nRoute"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'App/MyOwnControllers/UserController.index'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("由于你定义的控制器方法是路由处理程序，因此它们将接收 "),a("router-link",{attrs:{to:"/guides/concept/request-lifecycle.html"}},[t._v("HTTP Context")]),t._v(" 作为参数：")],1),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'use strict'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserController")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("index")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" response "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" UserController\n")])])])])},[],!1,null,null,null);s.default=e.exports}}]);