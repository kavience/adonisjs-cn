(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{227:function(s,t,a){"use strict";a.r(t);var r=a(0),n=Object(r.a)({},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"cors"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cors","aria-hidden":"true"}},[s._v("#")]),s._v(" CORS")]),s._v(" "),a("p",[s._v("跨源资源共享( CORS )是一种允许来自不同域的传入 HTTP 请求的方法。")]),s._v(" "),a("p",[s._v("在 AJAX 应用程序中非常常见，如果服务器未授权，浏览器会阻止所有跨域请求。")]),s._v(" "),a("p",[s._v("点击 "),a("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS",target:"_blank",rel:"noopener noreferrer"}},[s._v("这里"),a("OutboundLink")],1),s._v(" 了解更多关于 CORS。")]),s._v(" "),a("h2",{attrs:{id:"建立"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#建立","aria-hidden":"true"}},[s._v("#")]),s._v(" 建立")]),s._v(" "),a("p",[s._v("执行以下命令，通过 npm 安装中间件提供程序：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("adonis "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" @adonisjs/cors\n")])])]),a("p",[s._v("接下来，在 start/app.js 文件中注册提供程序：")]),s._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" providers "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@adonisjs/cors/providers/CorsProvider'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),a("p",[s._v("最后，在 start/kernel.js 文件中注册中间件：")]),s._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[s._v("Server\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Adonis/Middleware/Cors'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),a("h2",{attrs:{id:"配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置","aria-hidden":"true"}},[s._v("#")]),s._v(" 配置")]),s._v(" "),a("p",[s._v("CORS 的配置在 config/cors.js 文件中定义，并接受以下选项。")]),s._v(" "),a("h4",{attrs:{id:"起源"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#起源","aria-hidden":"true"}},[s._v("#")]),s._v(" 起源")]),s._v(" "),a("p",[s._v("允许进行跨域请求的来源。")]),s._v(" "),a("p",[s._v("返回以下值之一：")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("布尔值 true 或 false 拒绝当前请求源。")])]),s._v(" "),a("li",[a("p",[s._v("允许使用逗号分隔的域字符串。")])]),s._v(" "),a("li",[a("p",[s._v("允许的域数组。")])]),s._v(" "),a("li",[a("p",[s._v("一个函数，它接收当前请求源。在这里，你可以通过返回 true 或 false 来计算是否允许原点：")])])]),s._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[s._v("配置"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" cors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js\n"),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("origin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("currentOrigin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" currentOrigin "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mywebsite.com'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("对于其他选项，请检查"),a("a",{attrs:{href:"https://github.com/adonisjs/adonis-cors/blob/develop/config/cors.js#L3",target:"_blank",rel:"noopener noreferrer"}},[s._v("配置文件"),a("OutboundLink")],1),s._v("中的注释。")])])},[],!1,null,null,null);t.default=n.exports}}]);